actions:
  - name: analyseSiteTimespan
    definition:
      kind: synchronous
      handler: http://lalal.de
      forward_client_headers: true
      request_transform:
        body:
          action: transform
          template: |-
            {
              "site_id": {{$body.input.analyzeSiteRequestInput?['siteId']}},
              "model_id": {{$body.input.analyzeSiteRequestInput?['modelId']}},
              "start_datetime": {{$body.input.analyzeSiteRequestInput?['startDatetime']}},
              "end_datetime": {{$body.input.analyzeSiteRequestInput?['endDatetime']}}
            }
        method: POST
        query_params: {}
        template_engine: Kriti
        url: '{{$base_url}}/models/analyse-site-timespan'
        version: 2
      response_transform:
        body:
          action: transform
          template: |-
            {
              "jobId": {{$body?['job_id']}}
            }
        template_engine: Kriti
        version: 2
    permissions:
      - role: user
  - name: cancelJobById
    definition:
      kind: synchronous
      handler: '{{HASURA_WEBHOOKS_BASE_URL}}'
      forward_client_headers: true
      request_transform:
        body:
          action: transform
          template: '{}'
        method: POST
        query_params: {}
        template_engine: Kriti
        url: '{{$base_url}}/jobs/cancel/{{$body.input?.jobId}}'
        version: 2
    permissions:
      - role: user
    comment: Cancels a job by ID.
  - name: createSiteDataReport
    definition:
      kind: synchronous
      handler: '{{HASURA_WEBHOOKS_BASE_URL}}'
      forward_client_headers: true
      request_transform:
        body:
          action: transform
          template: |-
            {
              "site_id": {{$body.input.createDataReportRequestInput?['siteId']}}
            }
        method: POST
        query_params: {}
        template_engine: Kriti
        url: '{{$base_url}}/sites/create-data-report'
        version: 2
      response_transform:
        body:
          action: transform
          template: |-
            {
              "jobId": {{$body?['job_id']}}
            }
        template_engine: Kriti
        version: 2
    permissions:
      - role: user
  - name: listDataDirectories
    definition:
      kind: ""
      handler: '{{HASURA_WEBHOOKS_BASE_URL}}'
      forward_client_headers: true
      request_transform:
        method: GET
        query_params:
          subpath: '{{$body.input?.subpath}}'
        request_headers:
          add_headers: {}
          remove_headers:
            - content-type
        template_engine: Kriti
        url: '{{$base_url}}/sites/list-data-directories'
        version: 2
    permissions:
      - role: user
    comment: Lists all folders in the data directory. Optional subpath parameter to list specific subdirectory.
  - name: scanAllSiteDirectories
    definition:
      kind: synchronous
      handler: '{{HASURA_WEBHOOKS_BASE_URL}}'
      forward_client_headers: true
      request_transform:
        body:
          action: transform
          template: |-
            {
              "site_id": {{$body.input.siteDirectoriesScanRequestInput?['siteId']}}
            }
        method: POST
        query_params: {}
        template_engine: Kriti
        url: '{{$base_url}}/sites/scan-all-directories'
        version: 2
      response_transform:
        body:
          action: transform
          template: |-
            {
              "jobId": {{$body?['job_id']}}
            }
        template_engine: Kriti
        version: 2
    permissions:
      - role: user
  - name: scanSiteDirectory
    definition:
      kind: synchronous
      handler: '{{HASURA_WEBHOOKS_BASE_URL}}'
      forward_client_headers: true
      request_transform:
        body:
          action: transform
          template: |-
            {
              "site_id": {{$body.input.siteDirectoryScanRequestInput?['siteId']}},
              "directory": {{$body.input.siteDirectoryScanRequestInput?['directory']}}
            }
        method: POST
        query_params: {}
        template_engine: Kriti
        url: '{{$base_url}}/sites/scan-directory'
        version: 2
      response_transform:
        body:
          action: transform
          template: |-
            {
              "jobId": {{$body?['job_id']}}
            }
        template_engine: Kriti
        version: 2
    permissions:
      - role: user
custom_types:
  enums: []
  input_objects:
    - name: CreateDataReportRequestInput
    - name: SiteDirectoriesScanRequestInput
    - name: SiteDirectoryScanRequestInput
    - name: AnalyzeSiteRequestInput
  objects:
    - name: DirectoryInfo
    - name: ListDirectoriesResponse
    - name: ListDataDirectoriesResponse
    - name: CancelJobResponse
    - name: SiteDataReportResponse
    - name: SiteDirectoriesScanResponse
    - name: SiteDirectoryScanResponse
    - name: AnalyzeSiteResponse
  scalars:
    - name: JSON
